{% extends "accounts/base.html" %}
{% load i18n %}
{% load l10n %}
{% load static %}
{% block content %}
<!---------- First Part ---------->
<div class="d-sm-flex">
    <div class="py-2">
        <h3 class="text-capitalize">{% trans "Welcome, " %} {{ user.username }} !</h3>
    </div>
    <div class="py-2 ms-auto">
        <div class="d-flex">
            <h3>
                {% trans "Bonus" %}: {{ user_currency_symbol }}{{ object.bonus }}
            </h3>
            {% blocktrans asvar the_title with currency=user_currency_symbol %}
                The {{currency}}1000 bonus is a gift from us to every new user. It has no expiration date!
                Every time you transfer the accumulated interest to your balance,
                an equal amount will be taken out of your bonus.
            {% endblocktrans %}
            <a href="#" class="fas fa-question-circle p-2 red-tooltip"
                data-bs-toggle="tooltip" data-bs-placement="bottom" title="{{ the_title }}"></a>
        </div>
    </div>
</div>

<!---------- Second Part ---------->
<div class="d-md-flex bd-highlight">
    <!---------- ballance and yellow card ---------->
    <div class="bd-highlight">
        <!-- top part -->
        <div class="d-flex">
            <div class="pe-3">
                <i class="bi-cash-stack"></i>
            </div>
            <div class="align-self-center">
                <h1>{% trans "Ballance" %}</h1>
            </div>
        </div>
        <br>
        <!-- bottom part (card) -->
        <div class="card text-white home-card">
            <div class="card-body">
                <h5 class="fw-normal text-capitalize">
                    {% if is_bus == True %}
                        {% blocktrans with username=user.username %}
                            {{ username }}'s Business Account
                        {% endblocktrans %}
                    {% else %}
                        {% blocktrans with username=user.username %}
                            {{ username }}'s Personal Account
                        {% endblocktrans %}
                    {% endif %}
                </h5>
                <hr>
                <h1 class="fw-normal">{{ user_currency_symbol }}{{ object.total_balance }}</h1>
                {% trans "Current Balance" %}
            </div>
        </div>
    </div>
    <!----------------- Interest -------------------->
    <div class="bd-highlight ms-auto">
        <!-- top part -->
        <div class="d-flex pb-2">
            <div class="pe-3">
                <i class="bi bi-piggy-bank"></i>
            </div>
            <div class="align-self-center">
                <h1>{% trans "Interest" %}</h1>
            </div>
        </div>
        <!-- bottom part (counter) -->
        <div class="d-flex">
            <div class="d-flex counter-interest">
                <div>{{ user_currency_symbol }}</div>
                <div id="counter"></div>
            </div>
        </div>
        <br>
        <a href="{% url 'accounts:cash-out' object.pk %}" class="neon-button ml-2">{% trans "Cash Out" %}</a>
    </div>
</div>
<br>

<!---------- 4 buttons ---------->
<div class="row text-center">
    <a href="{% url 'accounts:add-money' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-download buttons-4"></i>
        <h3>{% trans "Deposit" %}</h3>
    </a>
    <a href="{% url 'accounts:transfer-search' pk=object.pk %}" class="col-md zoom" >
        <i class="bi bi-send-check buttons-4"></i>
        <h3>{% trans "Send Money" %}</h3>
    </a>
    <a href="{% url 'accounts:take-money' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-upload buttons-4"></i>
        <h3>{% trans "Withdraw" %}</h3>
    </a>
    <a href="{% url 'accounts:history' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-book-half buttons-4"></i>
        <h3>{% trans "Transaction History" %}</h3>
    </a>
</div>

<script>
    var total_bal = Number('{{ interest_list.interest|unlocalize }}');
    var interest_rate = Number('{{ interest_list.interest_rate|unlocalize }}');
    window.onload = function () {
        ctr = document.getElementById("counter");
        function incrementCounter() {
            ctr.innerHTML = interest_rate.toFixed(20);

            /* one percent of the total balance per second */
            interest = total_bal * 0.01 / 31536000
            interest_rate = interest_rate + interest

            /* timeout every second */
            setTimeout(incrementCounter, 1000);
        }
        if (total_bal > 0){
            /* loopdy loop back up untill infinity */
            incrementCounter();
        } else {
            ctr.innerHTML = "0.00000000000000000000";
        }
    }
</script>

{% endblock %}
