{% extends "accounts/base.html" %}
{% load i18n %}
{% load l10n %}
{% load static %}
{% block content %}
<!-- <div class="loader"></div> -->
<!---------- First Part ---------->
<div class="d-lg-flex">
    <div class="p-2 mr-auto">
        <h3 class="text-capitalize">{% trans "we pay you 1% interest on your balance !" %}</h3>
    </div>
    <div class="p-2">
        <div class="row">
            <h3>
                {% if LANGUAGE_CODE == 'de' %}
                    Bonus: €{{ euro_bonus }}
                {% else %}
                    Bonus: ${{ object.bonus }}
                {% endif %}
            </h3>
            {% blocktrans asvar the_title %}
                The $1000 bonus is a gift from us to every new user. It has no expiration date!
                Every time you transfer the accumulated interest to your balance,
                an equal amount will be taken out of your bonus.
            {% endblocktrans %}
            <a href="#" class="fas fa-question-circle p-2"
                data-toggle="tooltip" data-placement="bottom" 
                data-original-title="Tooltip on bottom" title="{{ the_title }}"></a>
        </div>
    </div>
</div>

<!---------- Second Part ---------->
<div class="d-lg-flex flex-row bd-highlight">
    <!---------- ballance and yellow card ---------->
    <div class="bd-highlight mr-auto">
        <!-- top part -->
        <div class="d-flex">
            <div class="pr-3">
                <i class="bi-cash-stack"></i>
            </div>
            <div class="align-self-center">
                <h1>{% trans "Ballance" %}</h1>
            </div>
        </div>
        <br>
        <!-- bottom part (card) -->
        <div class="card text-white home-card">
            <div class="card-body">
                <h5 class="font-weight-normal text-capitalize">
                    {% blocktrans with username=user.username %}
                        Name: {{ username }}
                    {% endblocktrans %}
                    {% if is_bus == True %}
                        <i class="fas fa-briefcase pl-2 pr-2"></i> (Business Account)
                    {% endif %}
                </h5>
                <hr>
                {% if LANGUAGE_CODE == 'de' %}
                    <h1 class="font-weight-normal">€{{ euro_balance }}</h1>
                {% else %}
                    <h1 class="font-weight-normal">${{ object.total_balance }}</h1>
                {% endif %}
                Current Balance
            </div>
        </div>
    </div>
    <!---------- Interest ---------->
    <div class="bd-highlight">
        <!-- top part -->
        <div class="d-flex pb-2">
            <div class="pr-3">
                <i class="bi bi-piggy-bank"></i>
            </div>
            <div class="align-self-center">
                <h1>{% trans "Interest" %}</h1>
            </div>
        </div>
        <!-- bottom part (counter) -->
        <div class="row">
            {% if LANGUAGE_CODE == 'de' %}
            <div class="d-flex counter-interest">
                <div class="">€</div>
                <div id="counter"></div>
            </div>
            {% else %}
            <div class="d-flex counter-interest">
                <div class="">$</div>
                <div id="counter"></div>
            </div>
            {% endif %}
        </div>
        <br>
        <a href="{% url 'accounts:cash-out' object.pk %}" class="neon-button">{% trans "Cash Out" %}</a>
    </div>
</div>
<br>

<!---------- 4 buttons ---------->
<div class="row text-center">
    <a href="{% url 'accounts:add-money' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-download buttons-4"></i>
        <h3>{% trans "Deposit" %}</h3>
    </a>
    <a href="{% url 'accounts:transfer' pk=object.pk %}" class="col-md zoom" >
        <i class="bi bi-send-check buttons-4"></i>
        <h3>{% trans "Send Money" %}</h3>
    </a>
    <a href="{% url 'accounts:take-money' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-upload buttons-4"></i>
        <h3>{% trans "Withdraw" %}</h3>
    </a>
    <a href="{% url 'accounts:history' pk=object.pk %}" class="col-md zoom">
        <i class="bi bi-book-half buttons-4"></i>
        <h3>{% trans "Transaction History" %}</h3>
    </a>
</div>

<script>
    var total_bal = Number('{{ interest_list.interest|unlocalize }}');
    var interest_rate = Number('{{ interest_list.interest_rate|unlocalize }}');
    var lang = '{{ LANGUAGE_CODE }}'
    var euro_rate = Number('{{ euro_rate|unlocalize }}')
    window.onload = function () {
        /* multiplying total balacne to get the euro equivalent */
        if (lang == "de") {
            total_bal = total_bal * euro_rate;
        }
        ctr = document.getElementById("counter");
        function incrementCounter() {
            ctr.innerHTML = interest_rate.toFixed(20);

            /* one percent of the total balance per second */
            interest = total_bal * 0.01 / 31536000
            interest_rate = interest_rate + interest

            /* timeout every second */
            setTimeout(incrementCounter, 1000);
        }
        if (total_bal > 0){
            /* loopdy loop back up untill infinity */
            incrementCounter();
        } else {
            ctr.innerHTML = "0.00000000000000000000";
        }
    }
</script>

<!-- <img class="img-fluid" src="{% static 'accounts/images/new-live.gif' %}" alt=""> -->
{% endblock %}
